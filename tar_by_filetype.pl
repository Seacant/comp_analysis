#!/usr/bin/perl

# TODO: Review this list. Maybe use something better than extension?
my $supported_filetypes = {
  perl       => ['pl', 'pm'],
  html       => ['html', 'htm'],
  js         => [
	          'cjsx', 'js', 'vue', 'ts', 'dts',
		  '.d.ts', 'tsx', 'jsx', 'coffee',
		  'es6', 'mjs', 'ejs'
	        ],
  c          => ['c', 'h'],
  cpp        => ['cpp', 'hpp', 'cc', 'ipp', 'hh', 'mm', 'c++'],
  java       => ['java'],
  css        => ['css', 'scss'],
  json       => ['json', 'cson', 'bson'],
  shell      => ['sh', 'bash', 'zsh'],
  php        => ['php', 'ctp', 'twig', 'phpt'],
  hask       => ['hs'],
  d          => ['d'],
  dart       => ['dart'],
  ps         => ['ps1', 'ps2'],
  lua        => ['lua'],
  sql        => ['slq'],
  nim        => ['nim'],
  scala      => ['scala', 'sc'],
  clojure    => ['cljs', 'clj', 'el'],
  swift      => ['swift'],
  batch      => ['bat'],
  s          => ['s'],
  rust       => ['rs'],
  text       => ['text', 'txt'],
  vimscript  => ['vim'],
  python     => ['py', 'exs'],
  markdown   => ['markdown', 'md'],
  xml        => ['xml', 'xsd', 'xlf', 'xaml'],
  html       => ['html', 'xhtml', 'xht', 'htm', 'phtml'],
  css        => ['css', 'scss', 'sass'],
  go         => ['go'],
  yaml       => ['yml', 'yaml'],
  toml       => ['toml'],
  json       => ['json'],
  ruby       => ['rb', 'erb', 'haml'],
  java       => ['java'],
  kotlin     => ['kt', 'kts'],
  csharp     => ['cs'],
  c          => ['c', 'h', 'headers'],
};

# TODO: Make this list autogenerated somehow?
my @repositories = (
  'vue',
  'react',
  'tensorflow',
  'react-native',
  'electron',
  'moby',
  'puppeteer',
  'TypeScript',
  'terminal',
  'jquery',
  'socket.io',
  'requests',
  'deno',
  'gatsby',
  'hugo',
  'bulma',
  'nw.js',
  'impress.js',
  'x64dbg',
  'realworld',
  'Alamofire',
  'gogs',
  'jQuery-File-Upload',
  'brackets',
  'tabIndent.js',
  'Ash',
  'SeeFood',
  'covfefe',
  'SDScreenshotCapture',
  'qr-code',
  'PlayAnimations',
  'poly-picker',
  'InteractiveViewControllerTransitions',
  'impress.js',
  'babel',
  'prettier',
  'anime',
  'AFNetworking',
  'Hilo',
  'instantclick',
  'emacs.d',
  'svgr',
  'cucumber-ruby',
  'PermissionScope',
  'tinycon',
  'django-allauth',
  'react-native-nw-react-calculator',
  'collect.js',
  'shadowsocks-android',
  'incubator-superset',
  'faceswap',
  'async',
  'traefik',
  'AndroidUtilCode',
  'algorithm-visualizer',
  'ijkplayer',
  'godot',
  'butterknife',
  'DefinitelyTyped',
  'Rocket.Chat',
  'pm2',
  'tesseract',
  'discourse',
  'github-cheat-sheet',
  'face_recognition',
  'legacy-homebrew',
  'frp',
  'apollo',
  'hyperapp',
  'parse-server',
  'react-navigation',
  'flv.js',
  'os-tutorial',
  'react-beautiful-dnd',
  'iris',
  'v2ray-core',
  'Hover',
  'symfony',
  'vuex',
  'pandas',
  'carbon',
  'swiper',
  'composer',
  'faker.js',
  'd4',
  'enclave',
  'Slash',
  'markdown-in-js',
  'dm-core',
  'apropos',
  'purplecoat.js',
  'steak',
  'flexbugs',
  'HikariCP',
  'ivideo',
  'envoy',
  'fd',
  'react-native-navigation',
  'Android-PickerView',
  'eos',
  'MaterialDrawer',
  'ARouter',
  'baiduyun',
  'z',
  'dbeaver',
  'requests-html',
  'ViewPagerIndicator',
  'Spoon-Knife',
  'RAP',
  '12306',
  'waifu2x',
  'typeahead.js',
  'bat',
  'osquery',
  'python-fire',
  'slate',
  'plyr',
  'bower',
  'echo',
  'stackedit',
  'servo',
  'cypress',
  'obs-studio',
  'the-super-tiny-compiler',
  'uppy',
  'swiper',
  'composer',
  'netty',
  'tidb',
  'iina',
  'mobx',
  'mkcert',
  'cmder',
  'localstack',
  'tabler',
  'PhotoSwipe',
  'iosched',
  'brew',
  'lerna',
  'redux-saga',
  'apollo',
  'npm',
  'awesome-shell',
  'picasso',
  'hyperapp',
  'metabase',
  'hyperapp',
  'parse-server',
  'new-pac',
  'aria2',
  'rollup',
  'shellcheck',
  'react-navigation',
  'ripgrep',
  'flv.js',
  'itsabot',
  'AndroidNote',
  'instaparse',
  'hubot-slack',
  'wallet',
  'lawnchair',
  'ImageProcessor',
  'xbmc-addons-chinese',
  'pokedex.org',
  'lumen',
  'BaiduPCS-Go',
  'picasso',
  'hyperapp',
  'ava',
  'imgui',
  'plyr',
  'bower',
  'sqlmap',
  'echo',
  'fks',
  'apollo',
  'highlight.js',
  'rocksdb',
  'underscore',
  'og-aws',
  'algorithm-visualizer',
  'ijkplayer',
  'godot',
  'butterknife',
  'slick',
  'nylas-mail',
  'DefinitelyTyped',
  'appium',
  'animated-tab-bar',
  'math-as-code',
  'Arduino',
  'vim-galore',
  'brook',
  'fasthttp',
  'laravel-debugbar',
  'redux-devtools-extension',
  'jquery-mobile',
  'node-jsonwebtoken',
  'htaccess',
  'PHPExcel',
  'kap',
  'locust',
  'KaTeX',
  'kcptun',
  'johnny-five',
  'paper.js',
  'Hover',
  'awesome-cpp',
  'symfony',
  'vuex',
  'EventBus',
  'CodeHub',
  'pandas',
  'devdocs',
  'js-cookie',
  'AR.js',
  'ipython',
  'folly',
  'f8app',
  'Carthage',
  'amphtml',
  'git-extras',
  'Material-Animations',
  'flatbuffers',
  'gotty',
  'incubator-weex',
  'cli',
  'lazydocker',
  'CocoaPods',
  'rbenv',
  'react-native-vector-icons',
  'seata',
  'node_redis',
  'scrcpy',
  'brew',
  'nodemon',
  'lerna',
  'redux-saga',
  'wepy',
  'vagrant',
  'framework',
  'GPUImage',
  'rancher',
  'store.js',
  'notable',
  'libra',
  'recharts',
  'homebridge',
  'Perfect',
  'IQKeyboardManager',
  'draggable',
  'docusaurus',
  'relay',
  'webpack-dashboard',
  'angular-seed',
  'Spring',
  'kivy',
  'redux-devtools-extension',
  'vConsole',
  'systemjs',
  'spree',
  'dotenv',
  'wechat-app-mall',
  'Mantle',
  'dgraph',
  'framework',
  'PHPExcel',
  'react-hot-loader',
  'vim-pathogen',
  'ivideo',
  'gmail',
  'jquery.complexify.js',
  'Reservoir',
  'objectify',
  'dsjslib',
  'NoNonsense-FilePicker',
  'XYOrigami',
  'Paparazzo',
  'MrVector',
  'ng2-material',
  'chalk',
  'uni-app',
  'HarmonyOS',
  'WaveFunctionCollapse',
  'MJRefresh',
  'electronic-wechat',
  'bazel',
  'Qix',
  'browserify',
  'electron-react-boilerplate',
  'solo',
  'goreplay',
  'CocoaLumberjack',
  'PHP-Parser',
  'yapi',
  'vimium',
  'cat',
  'AndroidSwipeLayout',
  'keep-a-changelog',
  'favorites-web',
  'twisted',
  'emojicon',
  'babel-preset-env',
  'CouchPotatoServer',
  'fishhook',
  'ntfy',
  'phantomjs-node',
  'redmine',
  'react-sortable-hoc',
  'RESideMenu',
  'zeal',
  'rails_admin',
  'startbootstrap-sb-admin-2',
  'qBittorrent',
  'shadowsocks-qt5',
  'metrics-graphics',
  'fingerprintjs2',
  'art-template',
  'jedis',
  'nodeclub',
  'connect',
  'c3',
  'seaweedfs',
  'Real-Time-Voice-Cloning',
  'TTTAttributedLabel',
  'bootstrap-select',
  'kitematic',
  'MagicalRecord',
  'browser-sync',
  'zsh-autosuggestions',
  'LightTable',
  'stb',
  'aos',
  'zstd',
  'bash-it',
  'core',
  'android-testing',
  'es5-shim',
  'OpenRA',
  'metrics',
  'page.js',
  'fmt',
  'tmux-resurrect',
  'XSStrike',
  'django-cms',
  'functions-samples',
  'APIJSON',
  'ios-oss',
  'ReflectionDocBlock',
  'nvd3',
  'multer',
  'omniauth',
  'pyecharts',
  'random_compat',
  'capnproto',
  'redux-observable',
  'android-testing',
  'f2',
  'page.js',
  'fmt',
  'tmux-resurrect',
  'grpc-java',
  'gitignore.io',
  'AppImageKit',
  'ngx-bootstrap',
  'wxBot',
  'haven',
  'vue-strap',
  'tensorpack',
  'cubism',
  'slack-term',
  'Nim',
  'high-speed-downloader',
  'ChakraCore',
  'dlib',
  'elasticsearch-analysis-ik',
  'sonnet',
  'Mailpile',
  'filepond',
  'PapaParse',
  'FileDownloader',
  'beets',
  'localtunnel',
  'laravel-ide-helper',
  'bourbon',
  'Sentinel',
  'javascript-patterns',
  'jupyterlab',
  'fabric',
  'python-spider',
  'laradock',
  'truffle',
  'plugins',
  'browser-laptop',
  'IBAnimatable',
  'textql',
  'EntityFrameworkCore',
  'node-mongodb-native',
  'tig',
  'sunflower',
  'jupyter',
  'nock',
  'fingerprintjs2',
  'art-template',
  'jedis',
  'server',
  'scoop',
  'connect',
  'TTTAttributedLabel',
  'ncnn',
  'spacegray',
  'solid',
  'FLAnimatedImage',
  'slate',
  'finagle',
  'solidity',
  'react-sortable-hoc',
  'skynet',
  'reactstrap',
  'WSL',
  'plugins',
  'learn-go-with-tests',
  'mono',
  'click',
  'markdown-it',
  'clojurescript',
  'awesome-laravel',
  'PNChart',
  'pytorch-CycleGAN-and-pix2pix',
  'UITableView-FDTemplateLayoutCell',
  'react-admin',
  'PayloadsAllTheThings',
  'hadoop',
  'xbmc',
  'list.js',
  'showdown',
  'knockout',
  'graphql-playground',
  'AndroidPdfViewer',
  'structured-text-tools',
  'terminal-notifier',
  'syntaxhighlighter',
  'darkflow',
  'signature_pad',
  'qmk_firmware',
  'acra',
  'fastnetmon',
  'awesome-android-tips',
  'autoComplete.js',
  'scalatra',
  'dlite',
  'elasticsearch-kopf',
  'Backbone-relational',
  'sublimetext-markdown-preview',
  'metrics-graphics',
  'face-api.js',
  'awesome-scala',
  'UltimateRecyclerView',
  'zookeeper',
  'react-table',
  'Mycat-Server',
  'django-cms',
  'ReflectionDocBlock',
  'nvd3',
  'flipper',
  'majestic',
  'django-debug-toolbar',
  'dio',
  'libzmq',
  'gocui',
  'xUtils3',
  'structor',
  'vue-storefront',
  'rocksdb',
  'uikit',
  'HanLP',
  'wekan',
  'Kingfisher',
  'curl',
  'phpunit',
  'kit',
  'musicbox',
  'monica',
  'jQuery-menu-aim',
  'janus',
  'vega',
  'Mac-CLI',
  'awesome-flask',
  'codelf',
  'jQuery-menu-aim',
  'janus',
  'MLAlgorithms',
  'botpress',
  'simple-icons',
  'easyexcel',
  'Android-ObservableScrollView',
  'mockito',
  'PocketHub',
  'packer',
  'Proton',
  'loaders.css',
  '_s',
  'tmuxinator',
  'fpm',
  'pdfmake',
  'tui.calendar',
  'frontend-guidelines',
  'android-ktx',
  'horovod',
  'react-jsonschema-form',
  'sovereign',
  'docker-elk',
  'http-prompt',
  'spectrum',
  'jstips',
  'vim-go',
  'node-jsonwebtoken',
  'htaccess',
  'PHPExcel',
  'kap',
  'Inquirer.js',
  'weui-wxss',
  'redux-devtools',
  'visdom',
  'awesomplete',
  'ccv',
  'maskrcnn-benchmark',
  'OpenRefine',
  'PathFinding.js',
  'redigo',
  'lime',
  'Android-Debug-Database',
  'Clusterize.js',
  'pnpm',
  'helmet',
  'rickshaw',
  'boto',
  'PicGo',
  'proxygen',
  'jwt-go',
  'notebook',
  'qt',
  'phoenix',
  'tinker',
  'glances',
  'recompose',
  'sharp',
  'validator.js',
  'winston',
  'websocketd',
  'MS-DOS',
  'airflow',
  'android-floating-action-button',
  'ethereumbook',
  'XLPagerTabStrip',
  'swc',
  'learnyounode',
  'TypeScript-Node-Starter',
  'autokeras',
  'ion',
  'typecho',
  'asuswrt-merlin',
  'yoga',
  'bitcoinbook',
  'requirejs',
  'diaspora',
  'flatpickr',
  'Chameleon',
  'java8-tutorial',
  'design-blocks',
  'inferno',
  'jenkins',
  'dva',
  'medium-editor',
  'wechat_jump_game',
  'ice',
  'RxJava-Android-Samples',
  'ui',
  'JsBridge',
  'ImmersionBar',
  'simplemde-markdown-editor',
  'zookeeper',
  'react',
  'falcon',
  'onnx',
  'shenzhen',
  'UpUp',
  'aeron',
  'wraith',
  'nodal',
  'freegeoip',
  'FastHub',
  'dnscat2',
  'ifvisible.js',
  'ENViews',
  'vue-sui-demo',
  's-tui',
  'npgsql',
  'inflector',
  'next-plugins',
  'microsoft.github.io',
  'laptop',
  'Laravel-Excel',
  'Tars',
  'junit4',
  'pickadate.js',
  'ducks-modular-redux',
  'robomongo',
  'Vulcan',
  'timescaledb',
  'nginx-proxy',
  'feathers',
  'redox',
  'bootswatch',
  'bokeh',
  'CocoaLumberjack',
  'PHP-Parser',
  'ScrollMagic',
  'micro',
  'zap',
  'electron-builder',
  'brotli',
  'codelf',
  'jQuery-menu-aim',
  'node-postgres',
  'janus',
  'react-native-router-flux',
  'Blazor',
  'labelImg',
  'python-telegram-bot',
  'FlameGraph',
  'webmagic',
  'Mars',
  'eureka',
  'Quick',
  'HMSegmentedControl',
  'ssh-chat',
  'byob',
  'swift-corelibs-foundation',
  'LiquidFloatingActionButton',
  'rabl',
  'MacGap1',
  'grpc-go',
  'recyclerview-animators',
  'foundationdb',
  'Arduino',
  'html5shiv',
  'botkit',
  'editor.js',
  'WaveFunctionCollapse',
  'googletest',
  'MJRefresh',
  'jsdom',
  'svgo',
  'electronic-wechat',
  'nuklear',
  'deep-image-prior',
  'promises',
  'gjson',
  'jsplumb',
  'closure-compiler',
  'jQuery-Knob',
  'piskel',
  'prerender-spa-plugin',
  'seamless-immutable',
  'gitleaks',
  'TypeResolver',
  'random_compat',
  'Dash-iOS',
  'vex',
  'micro',
  'sockjs-client',
  'Pikaday',
  'bgfx',
  'Lona',
  'esprima',
  'legit',
  'leaf',
  'pytext',
  'Awesome-Swift-Education',
  'rebound',
  'PyMySQL',
  'macvim',
  'css-only-chat',
  'scylla',
  'friendly_id',
  'pq',
  'TrafficMonitor',
  'mosby',
  'swift-nio',
  'nokogiri',
  'SpaceshipGenerator',
  'AndroidPerformanceMonitor',
  'text_classification',
  'speedtest-cli',
  'babun',
  'luxon',
  'incubator-druid',
  'arangodb',
  'api',
  'mosh',
  'MWPhotoBrowser',
  'simple-cache',
  'dc.js',
  'zdog',
  'AudioKit',
  'Gource',
  'codecombat',
  'xctool',
  'blockly',
  'BlocksKit',
  'PHP_CodeSniffer',
  'iOSProject',
  'JLRoutes',
  'deepo',
  'hanami',
  'node-formidable',
  'falcon-plus',
  'x-ray',
  'linkerd',
  'trump2cash',
  'Moya',
  'JSQMessagesViewController',
  'rough',
  'DeepSpeech',
  'CocoaAsyncSocket',
  'disruptor',
  'react-native-macos',
  'Material',
  'Mantle',
  'terminus',
  'autokeras',
  'ion',
  'asuswrt-merlin',
  'mopidy',
  'regexr',
  'fbctf',
  'chalice',
  'routing',
  'purescript',
  'logrus',
  'pytudes',
  'libra',
  'node-inspector',
  'recharts',
  'SwiftLint',
  'openpilot',
  'homebridge',
  'delve',
  'bk-cmdb',
  'frozenui',
  'openscad',
  'pyjwt',
  'unicorn',
  'learningPixi',
  'ring',
  'quietnet',
  'sly',
  'go-github',
  'ailab',
  'VitamioBundle',
  'RIBs',
  'hogan.js',
  'CssToInlineStyles',
  'graphene',
  'deep-residual-networks',
  'Gifski',
  'hotkeys',
  'KineticJS',
  'hyperopt',
  'devtool',
  'walk',
  'MediatR',
  'ImageAI',
  'nui',
  'Gifski',
  'hotkeys',
  'bilibili-mac-client',
  'perfmap',
  'KineticJS',
  'hyperopt',
  'devtool',
  'seajs',
  'google-api-nodejs-client',
  'magento2',
  'Workerman',
  'instantiator',
  'stylegan',
  'lexer',
  'hint.css',
  'musicbox',
  'SignalR',
  'Babylon.js',
  'autojump',
  'ViewPagerIndicator',
  'Spoon-Knife',
  'animated-tab-bar',
  'RAP',
  'TDengine',
  'flysystem',
  'Alcatraz',
  'bolt',
  'centrifugo',
  'WeChatTweak-macOS',
  'node-xml2js',
  'cloud-torrent',
  'cleaver',
  'shadowsocks-manager',
  'interview',
  'hexo-theme-material',
  'single-spa',
  'will_paginate',
  'Sylius',
  'theia',
  'distroless',
  'readthedocs.org',
  'spark',
  'SASM',
  'bullet3',
  'esprima',
  'css-selector',
  'KIF',
  'paramiko',
  'SDAutoLayout',
  'beeswithmachineguns',
  'overleaf',
  'Keras-GAN',
  'RoundedImageView',
  'mac-setup',
  'bullet',
  'jwt-go',
  'notebook',
  'qt',
  'http-kernel',
  'CefSharp',
  'networkx',
  'jupyter-themes',
  'EverydayWechat',
  'choo',
  'MahApps.Metro',
);

for my $directory (@repositories){
  for my $language (keys %$supported_filetypes){
    my @extensions = map { '-name "*.' . $_ . '"' } @{$supported_filetypes->{$language}};
    my $command = "find repositories/$directory "
        . join(" -o ", @extensions)
      . ' | tar -cf tars/' . $directory . '_' . $language . '.tar -T -'
    ;

    my $return = `$command`;
    print STDERR $return;
  }
}
